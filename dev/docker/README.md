# ci/dev

Запуск local/dev окружения. Для простоты поддержки запуск local и dev окружения объединен общим. 

Директория содержит такие файлы 

- `.env` файл в котором задаются всякие секреты в виде пар KEY=VALUE

[Трюк](https://docs.docker.com/compose/extends/) с использованием нескольких `docker-compose.*.yml` файлов позволил включать/выключать часть сервисов и переопеределять специфичные для локального использования параметры.

В общем виде структура такая

- `docker-compose.yml` - основной файл в котором описаны сервисы (backend, frontend, фоновые сервисы backend) без баз данных, очередей и кешей
- `docker-compose.override.yml` - файл в котором добавляются базы данных, очереди и кеши, нужен только в `local` окружении, на `dev` используются внешние базы, очереди и кеши
- `docker-compose.dev.yml` - файл в котором происходит добавление `labels` для интеграции с traefik reverse proxy, чтобы привязывать проект на dev окружении к нужному поддомену, также там же сервисы добавляются в нужные подсети, для досутпа к внешним базам, очередям и кешам.
- `docker-compose.local.yml` - файл который в `.gitignore` нужен для переопределения под нужды `local` окружения при этом изменения не утекают в `git` просто для удобства.
- В файле `.env` есть переменная `COMPOSE_FILE` в которой через `:` указываются какие и в какой последовательности используются `*.yml` файлы.

